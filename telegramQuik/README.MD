Решение для отправки (получения) сообщений из терминала Квик в Телеграм (telegram bot api), отправка почты.

В решении используется библиотека Telegram.Bot https://github.com/TelegramBots/Telegram.Bot 

Консольная программа MessagesQServer.exe, выполняющая функцию Named Pipe Server и Telegram Bot, отправка почты.
Файл settings.ini должен быть расположен рядом с MessagesQServer.exe.
Библиотека luaPipe.dll - библиотека передачи данных (Named Pipe) в консольную программу (сервер).
Библиотека luaPipe.dll - не обязателна к использованию, т.к. lua позволяет открывать именованные каналы используя io.open.
Тестовый скрипт luaPipeTest.lua

В свои скрипты необходимо подключить библиотеку luaPipe.dll (не обязательно), обеспечить запуск MessagesQServer.exe.
Для запуска лучше использовать файл startTeleServer.bat. В нем происходит проверка, что сервер уже запущен.

Чтобы собрать MessagesQServer необходимо установить в проект пакет Telegram.Bot

В файле settings.ini необходимо заполнить токен, полученный при регистрации бота в телеграме.

ID Чата можно получить также через телеграм или можно отправить сообщение в созданном чате бота и сервер примет его и зарегестрируется на него.

Важно: для корректной работы в Windows 7 необходимо:
- Windows 7 SP1
- Установить дополнение https://support.microsoft.com/en-us/topic/update-to-enable-tls-1-1-and-tls-1-2-as-default-secure-protocols-in-winhttp-in-windows-c4bd73d2-31d7-761e-0178-11268bb10392

Update.
Теперь проект (и собранная программа) называется MessagesQServer.
Помимо отправки сообщений в Телеграм добавлена возможность отправки почты.
Для этого необходимо включить отправку почты в настройках (значние ON), задать параметры smtp сервера.
Для отправки почты создается отдельный pipe канал (имя по умолчанию email_pipe).

Используя скрипт startTeleServer.bat при старте своего скрипта можно проверить, что сервер запущен, если нет, то запустить его.
Т.о. если он уже запущен не произойдет запуск дубля.

Update 2022.02.03
Новая версия, использующая Telegram.Bot v17.0.0 и C# 8.0

Ссылка на собранные библиотеки https://yadi.sk/d/QLT64ucTaLrjTQ
Ссылка на собранные библиотеки с Telegram.Bot to v17.0.0 https://disk.yandex.ru/d/D_FFo5IEn35VGw

Небольшое видео работы
https://youtu.be/14c4nQiDdfU

Пример настроек
https://youtu.be/Vy_m7qUwirY
